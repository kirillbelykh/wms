{% extends "index.html" %}

{% block content %}
<div class="max-w-4xl mx-auto mt-8">
  <h1 class="text-3xl font-bold mb-6">–¢–æ–≤–∞—Ä—ã</h1>

  <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ -->
  <form action="/items/create" method="post" class="flex gap-2 mb-6">
    <input type="text" name="name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" required
           class="border rounded px-3 py-2 flex-1">
    <input type="text" name="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"
           class="border rounded px-3 py-2 flex-1">
    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">–°–æ–∑–¥–∞—Ç—å</button>
  </form>

  <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
  <ul class="space-y-4">
    {% for item in items %}
    <li class="flex justify-between items-center p-4 border rounded hover:shadow">
      <div>
        <h2 class="font-semibold text-lg">{{ item.name or '–ù–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è' }}</h2>
        <p class="text-gray-500">{{ item.description or '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è' }}</p>
        <p class="text-sm text-gray-400">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {{ item.quantity }}</p>
      </div>
      <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è -->
      <button onclick="deleteItem({{ item.id }}, this)" 
              class="text-red-500 hover:text-red-700 ml-4">
        üóëÔ∏è
      </button>
    </li>
    {% endfor %}
  </ul>
</div>

<script>
async function deleteItem(itemId, button) {
  if (!confirm('–í—ã —Ç–æ—á–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) return;

  try {
    const response = await fetch(`/items/delete/${itemId}`, {
      method: 'DELETE'
    });

    if (response.ok) {
      // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
      button.closest('li').remove();
    } else {
      alert('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä');
    }
  } catch (err) {
    console.error(err);
    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞');
  }
}
</script>
{% endblock %}